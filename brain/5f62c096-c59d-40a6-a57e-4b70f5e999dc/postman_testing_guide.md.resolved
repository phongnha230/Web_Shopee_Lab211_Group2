# ğŸ“® HÆ°á»›ng Dáº«n Test News API trÃªn Postman

## ğŸš€ Chuáº©n Bá»‹

### 1. Khá»Ÿi Ä‘á»™ng Backend Server

```bash
cd backend
npm run dev
```

**Äá»£i cho Ä‘áº¿n khi tháº¥y:**
```
ğŸ—„ï¸  Sequelize models synced
ğŸš€ Server running on port 5000
```

### 2. Má»Ÿ Postman

- Náº¿u chÆ°a cÃ³, download táº¡i: https://www.postman.com/downloads/
- Hoáº·c dÃ¹ng Postman Web: https://web.postman.com/

---

## ğŸ“‹ API Endpoints Cáº§n Test

### Base URL
```
http://localhost:5000/api
```

---

## 1ï¸âƒ£ GET All News (Public)

### Request

**Method:** `GET`  
**URL:** `http://localhost:5000/api/news`  
**Headers:** KhÃ´ng cáº§n

### Postman Setup:
1. Chá»n method: **GET**
2. Nháº­p URL: `http://localhost:5000/api/news`
3. Click **Send**

### Expected Response (200 OK):
```json
{
  "data": [],
  "pagination": {
    "total": 0,
    "page": 1,
    "totalPages": 0
  }
}
```

### Test vá»›i Query Parameters:

**URL:** `http://localhost:5000/api/news?page=1&limit=10&status=published`

**Query Params trong Postman:**
- `page`: `1`
- `limit`: `10`
- `status`: `published` (hoáº·c `draft`, `archived`)

---

## 2ï¸âƒ£ GET Single News by ID (Public)

### Request

**Method:** `GET`  
**URL:** `http://localhost:5000/api/news/1`  
**Headers:** KhÃ´ng cáº§n

### Postman Setup:
1. Chá»n method: **GET**
2. Nháº­p URL: `http://localhost:5000/api/news/1` (thay `1` báº±ng ID thá»±c táº¿)
3. Click **Send**

### Expected Response (200 OK):
```json
{
  "id": 1,
  "title": "Sample News",
  "content": "This is the content",
  "image_url": "/uploads/image.jpg",
  "status": "published",
  "created_by": 1,
  "created_at": "2025-12-11T15:00:00.000Z",
  "updated_at": "2025-12-11T15:00:00.000Z",
  "is_pinned": false,
  "author": {
    "id": 1,
    "username": "admin",
    "email": "admin@example.com"
  }
}
```

### Expected Response (404 Not Found):
```json
{
  "message": "News not found"
}
```

---

## 3ï¸âƒ£ POST Create News (Admin Only) ğŸ”’

### âš ï¸ YÃªu Cáº§u Authentication

TrÆ°á»›c tiÃªn, báº¡n cáº§n **login Ä‘á»ƒ láº¥y token**.

### Step 1: Login Ä‘á»ƒ láº¥y Token

**Method:** `POST`  
**URL:** `http://localhost:5000/api/users/login`  
**Headers:**
- `Content-Type`: `application/json`

**Body (raw JSON):**
```json
{
  "email": "admin@example.com",
  "password": "your_password"
}
```

**Postman Setup:**
1. Chá»n method: **POST**
2. URL: `http://localhost:5000/api/users/login`
3. Tab **Headers**: Add `Content-Type: application/json`
4. Tab **Body** â†’ chá»n **raw** â†’ chá»n **JSON**
5. Paste JSON body á»Ÿ trÃªn (thay email/password tháº­t)
6. Click **Send**

**Response:**
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 1,
    "username": "admin",
    "email": "admin@example.com",
    "role": "admin"
  }
}
```

**ğŸ“ Copy token nÃ y Ä‘á»ƒ dÃ¹ng cho cÃ¡c request tiáº¿p theo!**

---

### Step 2: Create News

**Method:** `POST`  
**URL:** `http://localhost:5000/api/news`  
**Headers:**
- `Content-Type`: `application/json`
- `Authorization`: `Bearer YOUR_TOKEN_HERE`

**Body (raw JSON):**
```json
{
  "title": "Breaking News: Coffee Shop Opens!",
  "content": "We are excited to announce the grand opening of our new coffee shop. Come visit us for the best coffee in town!",
  "status": "published"
}
```

**Postman Setup:**
1. Chá»n method: **POST**
2. URL: `http://localhost:5000/api/news`
3. Tab **Headers**:
   - Add `Content-Type: application/json`
   - Add `Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...` (paste token tá»« login)
4. Tab **Body** â†’ chá»n **raw** â†’ chá»n **JSON**
5. Paste JSON body á»Ÿ trÃªn
6. Click **Send**

### Expected Response (201 Created):
```json
{
  "id": 1,
  "title": "Breaking News: Coffee Shop Opens!",
  "content": "We are excited to announce the grand opening...",
  "status": "published",
  "created_by": 1,
  "image_url": null,
  "created_at": "2025-12-11T15:00:00.000Z",
  "updated_at": "2025-12-11T15:00:00.000Z",
  "is_pinned": false
}
```

### Test vá»›i Image Upload:

**Method:** `POST`  
**URL:** `http://localhost:5000/api/news`  
**Headers:**
- `Authorization`: `Bearer YOUR_TOKEN_HERE`
- âš ï¸ **KHÃ”NG** thÃªm `Content-Type` (Postman tá»± set khi upload file)

**Body (form-data):**
1. Tab **Body** â†’ chá»n **form-data**
2. Add cÃ¡c fields:
   - `title` (Text): `News with Image`
   - `content` (Text): `This news has an image`
   - `status` (Text): `published`
   - `image` (File): Click **Select Files** vÃ  chá»n áº£nh

---

## 4ï¸âƒ£ PUT Update News (Admin Only) ğŸ”’

**Method:** `PUT`  
**URL:** `http://localhost:5000/api/news/1`  
**Headers:**
- `Content-Type`: `application/json`
- `Authorization`: `Bearer YOUR_TOKEN_HERE`

**Body (raw JSON):**
```json
{
  "title": "Updated News Title",
  "content": "Updated content here",
  "status": "archived"
}
```

**Postman Setup:**
1. Chá»n method: **PUT**
2. URL: `http://localhost:5000/api/news/1` (thay `1` báº±ng ID thá»±c táº¿)
3. Tab **Headers**:
   - Add `Content-Type: application/json`
   - Add `Authorization: Bearer YOUR_TOKEN`
4. Tab **Body** â†’ **raw** â†’ **JSON**
5. Paste JSON body
6. Click **Send**

### Expected Response (200 OK):
```json
{
  "id": 1,
  "title": "Updated News Title",
  "content": "Updated content here",
  "status": "archived",
  "created_by": 1,
  "image_url": null,
  "created_at": "2025-12-11T15:00:00.000Z",
  "updated_at": "2025-12-11T15:30:00.000Z",
  "is_pinned": false
}
```

---

## 5ï¸âƒ£ DELETE News (Admin Only) ğŸ”’

**Method:** [DELETE](file:///c:/Users/HPPAVILION/Documents/Cusor/Cafe_app/my-app/Frontend/src/constants/apiEndpoints.js#17-18)  
**URL:** `http://localhost:5000/api/news/1`  
**Headers:**
- `Authorization`: `Bearer YOUR_TOKEN_HERE`

**Postman Setup:**
1. Chá»n method: **DELETE**
2. URL: `http://localhost:5000/api/news/1`
3. Tab **Headers**:
   - Add `Authorization: Bearer YOUR_TOKEN`
4. Click **Send**

### Expected Response (200 OK):
```json
{
  "message": "News deleted successfully"
}
```

---

## ğŸ¯ Test Cases NÃªn Thá»­

### âœ… Happy Path (ThÃ nh cÃ´ng)

1. **GET all news** â†’ Expect: 200, empty array hoáº·c list news
2. **Login as admin** â†’ Expect: 200, token
3. **POST create news** (vá»›i token) â†’ Expect: 201, news object
4. **GET all news** â†’ Expect: 200, array cÃ³ 1 news
5. **GET single news** â†’ Expect: 200, news object
6. **PUT update news** (vá»›i token) â†’ Expect: 200, updated news
7. **DELETE news** (vá»›i token) â†’ Expect: 200, success message
8. **GET all news** â†’ Expect: 200, empty array

### âŒ Error Cases (Lá»—i)

1. **POST create news KHÃ”NG cÃ³ token** â†’ Expect: 401 Unauthorized
2. **POST create news vá»›i token customer** â†’ Expect: 403 Forbidden
3. **POST create news thiáº¿u title** â†’ Expect: 400 Bad Request
4. **GET news vá»›i ID khÃ´ng tá»“n táº¡i** â†’ Expect: 404 Not Found
5. **PUT update news cá»§a ngÆ°á»i khÃ¡c** â†’ Expect: 403 Forbidden
6. **DELETE news KHÃ”NG cÃ³ token** â†’ Expect: 401 Unauthorized

---

## ğŸ” Kiá»ƒm Tra Káº¿t Quáº£

### Trong Postman:

1. **Status Code** (gÃ³c trÃªn bÃªn pháº£i):
   - âœ… `200 OK` - ThÃ nh cÃ´ng
   - âœ… `201 Created` - Táº¡o má»›i thÃ nh cÃ´ng
   - âŒ `400 Bad Request` - Dá»¯ liá»‡u khÃ´ng há»£p lá»‡
   - âŒ `401 Unauthorized` - ChÆ°a login
   - âŒ `403 Forbidden` - KhÃ´ng cÃ³ quyá»n
   - âŒ `404 Not Found` - KhÃ´ng tÃ¬m tháº¥y
   - âŒ `500 Internal Server Error` - Lá»—i server

2. **Response Body** (tab Body):
   - Kiá»ƒm tra JSON response cÃ³ Ä‘Ãºng format khÃ´ng
   - Kiá»ƒm tra data cÃ³ Ä‘Ãºng khÃ´ng

3. **Response Time** (gÃ³c dÆ°á»›i):
   - NÃªn < 500ms cho API Ä‘Æ¡n giáº£n

### Trong Backend Terminal:

Xem logs Ä‘á»ƒ debug:
```
GET /api/news 200 45.123 ms - 123
POST /api/news 201 89.456 ms - 234
```

---

## ğŸ’¡ Tips

### 1. LÆ°u Token vÃ o Environment Variable

Trong Postman:
1. Click **Environments** (gÃ³c trÃªn bÃªn trÃ¡i)
2. Táº¡o environment má»›i: `Cafe App Local`
3. Add variable:
   - `base_url`: `http://localhost:5000/api`
   - `token`: `YOUR_TOKEN_HERE`
4. DÃ¹ng trong request:
   - URL: `{{base_url}}/news`
   - Header: `Authorization: Bearer {{token}}`

### 2. Táº¡o Collection

1. Click **Collections** â†’ **Create Collection**
2. TÃªn: `Cafe App - News API`
3. Add cÃ¡c requests vÃ o collection
4. CÃ³ thá»ƒ export/import Ä‘á»ƒ share

### 3. Auto-save Token sau Login

Trong tab **Tests** cá»§a login request:
```javascript
var jsonData = pm.response.json();
pm.environment.set("token", jsonData.token);
```

---

## ğŸ› Troubleshooting

### Lá»—i: "Could not get any response"
- âœ… Kiá»ƒm tra backend server Ä‘ang cháº¡y
- âœ… Kiá»ƒm tra URL Ä‘Ãºng: `http://localhost:5000/api/news`
- âœ… Táº¯t VPN/Proxy

### Lá»—i: 401 Unauthorized
- âœ… Kiá»ƒm tra Ä‘Ã£ thÃªm Authorization header chÆ°a
- âœ… Kiá»ƒm tra token cÃ²n háº¡n khÃ´ng (JWT cÃ³ thá»ƒ expire)
- âœ… Login láº¡i Ä‘á»ƒ láº¥y token má»›i

### Lá»—i: 500 Internal Server Error
- âœ… Xem backend terminal logs
- âœ… Kiá»ƒm tra database Ä‘ang cháº¡y
- âœ… Kiá»ƒm tra column `status` Ä‘Ã£ Ä‘Æ°á»£c thÃªm chÆ°a

### Lá»—i: CORS Error
- âœ… Kiá»ƒm tra `FRONTEND_URL` trong backend [.env](file:///c:/Users/HPPAVILION/Documents/Cusor/Cafe_app/my-app/backend/.env)
- âœ… Postman thÆ°á»ng khÃ´ng bá»‹ CORS (chá»‰ browser má»›i bá»‹)

---

## âœ… Checklist Test

- [ ] Backend server Ä‘ang cháº¡y (port 5000)
- [ ] Database Ä‘ang cháº¡y (MySQL port 3307)
- [ ] Column `status` Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o báº£ng `news`
- [ ] ÄÃ£ login vÃ  láº¥y Ä‘Æ°á»£c token
- [ ] GET all news â†’ 200 OK
- [ ] POST create news (vá»›i token) â†’ 201 Created
- [ ] GET single news â†’ 200 OK
- [ ] PUT update news (vá»›i token) â†’ 200 OK
- [ ] DELETE news (vá»›i token) â†’ 200 OK
- [ ] Test error cases (401, 403, 404)

---

**ChÃºc báº¡n test thÃ nh cÃ´ng! ğŸš€**

Náº¿u gáº·p lá»—i gÃ¬, check backend terminal logs vÃ  bÃ¡o láº¡i cho tÃ´i nhÃ©!
